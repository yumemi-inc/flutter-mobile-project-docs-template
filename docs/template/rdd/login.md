<!--
このドキュメントは「ログイン」機能の詳細機能要件定義書のテンプレートです。

【使い方】
- 本テンプレートはログイン機能の詳細な要件を整理・共有するためのものです。
- 必要に応じて要件を追加・修正してください。
- 用語や表現の統一、重複の回避に注意してください。

【カラム説明】
| 機能名 | 機能の説明 | 備考 | テクニカルノート |
|-|-|-|-|
| 機能の名称 | 機能説明 | 補足事項や関連情報 | バリデーションの定義など技術情報 |
-->

# ログイン機能 詳細機能要件定義書テンプレート

## 概要

<!--
このセクションには、ログイン機能の目的や背景、利用シーンなどを記載してください。
-->

本ドキュメントは、スマートフォンアプリにおける「ログイン」機能の詳細な要件を定義します。ユーザーが安全かつ簡単にアカウントへアクセスできることを目的とします。

## 機能一覧

<!--
このセクションには、ログイン機能に含まれる主な機能を一覧で記載してください。
- 例としてよくある業務要件を記載しています。不要なものは削除し、必要に応じて追加・修正してください。
-->

<!-- markdownlint-disable MD033 -->

| 機能名 | 機能の説明 | 備考 | テクニカルノート |
|-|-|-|-|
| メールアドレス入力 | メールアドレスを表示されたキーボード上で文字入力する。<br><br> 入力キーボードは、半角英数字と記号が表示されること。 | | **バリデーション** <br>正規表現によるバリデーション<br><br>入力された文字数が 1 文字以上であること。|
| パスワード入力 | パスワードを表示されたキーボード上で文字入力する。<br><br> 入力キーボードは、半角英数字と記号が表示されること。 | | **バリデーション** <br>半角英数記号であること<br><br>入力された文字数が 4 文字以上 ８文字以下であること。|
| パスワード非表示切替 | パスワード入力欄の表示/非表示を切り替えられる | | アイコンタップで表示/非表示切替、セキュリティ考慮 |
| 一次認証（メールアドレス＋パスワード認証） |**登録認証に成功した場合**<br>PIN コード入力を実施する機能に遷移する<br><br> **登録認証に失敗した場合**<br>エラーメッセージなどを表示する。| | |
| PINコード入力 | PINコードを表示されたキーボード上で文字入力する。<br><br> 入力キーボードは、半角数字が表示されること。| | **バリデーション** <br>半角数字４桁固定|
| 二次認証（PINコード認証） |**職員登録認証に成功した場合**<br>会員画面に遷移する<br><br> **登録認証に失敗した場合**<br>エラーメッセージなどを表示する。<br> **PINコード再送信** <br>ユーザーがPINコードを再送信できる| | |
| アカウントロック | PINコード認証失敗が一定回数を超えた場合にアカウントをロックする | ロック解除方法は別途定義 | |

<!-- markdownlint-enable MD033 -->

## シナリオ

<!--
このセクションには、ログイン機能の主な利用シナリオやユーザーフローを記載してください。
- 例としてよくある業務要件を記載しています。不要なものは削除し、必要に応じて追加・修正してください。
-->

1. ユーザーがアプリを起動し、ログイン画面が表示される。
2. ユーザーがメールアドレスとパスワードを入力し、「ログイン」ボタンを押下する。
3. 入力値のバリデーションが行われる。
4. サーバーに一次認証リクエストを送信する。
5. 一次認証成功時、サーバーが4桁のPINコードを生成し、メールでユーザーに送信する。
6. ユーザーがPINコード入力画面で受信したPINコードを入力し、「認証」ボタンを押下する。
7. 入力PINコードのバリデーションが行われる。
8. サーバーでPINコードを照合し、一致すれば認証成功・ホーム画面へ遷移。
9. PINコードが不一致または有効期限切れの場合はエラーメッセージを表示。
10. 必要に応じてPINコードの再送信が可能。

## ログイン機能内で端末に永続保存するデータ一覧

<!--
このセクションには、ログイン機能で端末に永続保存するデータ項目を記載してください。
- 例としてよくある業務要件を記載しています。不要なものは削除し、必要に応じて追加・修正してください。
-->

- ユーザーID
- PIN コード
- アクセスキー(API Key)

## ロック機能に関して

<!--
このセクションには、アカウントロック機能の仕様や解除方法、注意点などを記載してください。
- 例としてよくある業務要件を記載しています。不要なものは削除し、必要に応じて追加・修正してください。
-->

- 一定回数（例：5回）以上ログインに失敗した場合、アカウントをロックする。
- ロック状態ではログイン不可とし、エラーメッセージを表示する。
- ロック解除は「パスワード再設定」または管理者による解除とする。
- ロック状態や解除方法の詳細はセキュリティポリシーに準拠する。
