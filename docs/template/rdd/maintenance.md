<!--
このドキュメントは「メンテナンスモード」機能の詳細機能要件定義書のテンプレートです。

【使い方】
- 本テンプレートはメンテナンスモード機能の詳細な要件を整理・共有するためのものです。
- 必要に応じて要件を追加・修正してください。
- 用語や表現の統一、重複の回避に注意してください。

【カラム説明】
| カテゴリ- | サブカテゴリ- | 機能名 | 機能の説明 | 備考 | テクニカルノート |
|-|-|-|-|-|-|
| カテゴリ- | サブカテゴリ- | 機能の名称 | 機能説明 | 補足事項や関連情報 | バリデーションの定義など技術情報 |
-->

# メンテナンスモード機能 詳細機能要件定義書テンプレート

## 概要

<!--
このセクションには、メンテナンスモード機能の目的や背景、利用シーンなどを記載してください。
- 例としてよくある業務要件を記載しています。不要なものは削除し、必要に応じて追加・修正してください。
-->

本ドキュメントは、スマートフォンアプリにおける「メンテナンスモード」機能の詳細な要件を定義します。システム保守やアップデート時にユーザーへ適切にメンテナンス情報を通知し、サービスの一時停止や制限を安全に実施することを目的とします。メンテナンスモードの設定値はサーバーから取得することを前提とします。

## 機能一覧

<!--
このセクションには、メンテナンスモード機能に含まれる主な機能を一覧で記載してください。
- 例としてよくある業務要件を記載しています。不要なものは削除し、必要に応じて追加・修正してください。
-->

<!-- markdownlint-disable MD033 -->

| カテゴリ | サブカテゴリ| 機能名 | 機能の説明 | 備考 | テクニカルノート |
|-|-|-|-|-|-|
| メンテナンスモード | 定期メンテナンスモード | 有効設定 | サーバーから取得した設定値によりアプリがメンテナンスモードかどうかを判定する<br><br>メンテナンスモード中にアプリ内の機能を使用できない。 | **定期メンテナンス情報** <br><br>2か月に一度、日曜日の午前1時～午前3時にサーバー停止してメンテナンスを実施 | |
| | | 無効設定 | サーバーから取得した設定値によりアプリがメンテナンスモードかどうかを判定する<br><br>通常通りアプリ内の機能を使用できる。 | | |
| | スマホアプリ固有のメンテナンスモード | 有効設定 | サーバーから取得した設定値により、アプリ固有の不具合や障害発生時にメンテナンスモードへ切り替える。<br><br>対象バージョンやOSごとにメンテナンス画面を表示し、通常機能を利用不可にする。 | **アプリ固有の障害対応** <br><br>重大な不具合発生時や特定バージョンのみ制限したい場合に利用 | 対象バージョン・OS判定、強制アップデート連携 |
| | | 無効設定 | | | |

<!-- markdownlint-enable MD033 -->

## シナリオ

<!--
このセクションには、メンテナンスモード機能の主な利用シナリオやユーザーフローを記載してください。
- 例としてよくある業務要件を記載しています。不要なものは削除し、必要に応じて追加・修正してください。
- シナリオが簡単な場合は文章で、複雑な場合はフロー図（シーケンス図や状態遷移図など）で記載することも検討してください。
-->

1. アプリ起動時または定期的にサーバーへメンテナンス情報をリクエストする。
2. サーバーがメンテナンス中の場合、アプリはメンテナンス画面を表示し、通常機能を利用不可にする。
3. メンテナンス理由・期間・問い合わせ先等を画面に表示する。
4. メンテナンス終了後、アプリは自動的に通常画面へ復帰する。

## メンテナンスモード中の画面

<!--
このセクションには、メンテナンスモード中にアプリで表示する画面の画像やUI例、注意点などを記載してください。
- 例：メンテナンス理由、期間、問い合わせ先、ロゴやイラスト、再試行ボタンの有無など
- ユーザーに分かりやすく、誤解を招かない表現・デザインとすること

サンプル:

### 画像

<img src="maintenance_sample.png" width="300" />

### UIの注意点
- メンテナンス理由・期間・問い合わせ先は必ず明記し、ユーザーが不安にならないようにする
- メンテナンス終了後は自動的に通常画面へ復帰する仕組みを用意する
- 再試行ボタンは連打によるサーバー負荷を避けるため、一定間隔でのみ有効にする
- 色使いや文言は緊急性を煽りすぎず、落ち着いたトーンで統一する
- アクセシビリティ（音声読み上げ対応、十分なコントラストなど）にも配慮する
-->

### 画像

### UIの注意点

## メンテナンスモードの設定値を設置する場所

<!--
このセクションには、メンテナンスモードの設定値をどこで管理・取得するかを記載してください。
- 例としてよくある業務要件を記載しています。不要なものは削除し、必要に応じて追加・修正してください。
-->

- サーバー側でメンテナンスモードの設定値（例：is_maintenance, reason, start_time, end_time, contact_info など）を管理
- アプリは起動時や定期的にサーバーAPI（例：/maintenance/info）から設定値を取得
- 設定値はJSON形式でアプリに返却

## 対応するメンテナンスモードのケース

<!--
このセクションには、想定されるメンテナンスモードのケースを記載してください。
-->

### 定期メンテナンス

- 2か月に一度、日曜日の午前1時～午前3時にサーバー停止して実施されるメンテナンス
- サーバー側でスケジュール管理し、該当時間帯はis_maintenance=trueを返却

### スマホアプリ固有のメンテナンス

- アプリ固有の重大な不具合が発生した場合に実施されるメンテナンス
- サーバー側で対象バージョンやOSを指定してis_maintenance=trueを返却
- 必要に応じて強制アップデートも同時に案内

## 開発環境でメンテナンスモードの動作検証する方法

<!--
このセクションには、開発環境でメンテナンスモードの動作を検証する方法を記載してください。
-->

- 開発用サーバーでis_maintenance=trueのレスポンスを返すように設定
- メンテナンス理由や期間、問い合わせ先などのダミーデータを返却
- アプリを起動し、メンテナンス画面が正しく表示されるか、通常画面への復帰ができるかを確認
- 強制アップデートや通知連携の動作も合わせて検証
